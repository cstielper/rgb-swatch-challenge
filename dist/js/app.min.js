"use strict";var _createClass=function(){function e(e,s){for(var t=0;t<s.length;t++){var n=s[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(s,t,n){return t&&e(s.prototype,t),n&&e(s,n),s}}();function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}var UIElements={userPane:document.getElementById("user-info"),header:document.querySelector("header"),msgPane:document.getElementById("messages"),grid:document.getElementById("grid"),gameSettingsForm:document.getElementById("form-game-settings"),userInfoForm:document.getElementById("form-user-info"),cssClasses:{tile:"tile",active:"active",inactive:"inactive",error:"danger",warn:"warn",success:"success"}},gameModeOpts={easy:{items:16,guesses:12},medium:{items:16,guesses:8},hard:{items:16,guesses:4}},gameSettings={},Settings=function(){function e(s,t,n){_classCallCheck(this,e),this.items=s,this.guesses=t,this.answer=n}return _createClass(e,[{key:"removeGuess",value:function(){this.guesses-=1}}]),e}(),lsKey="rgb-swatch-app",LsObj=function e(s,t,n){_classCallCheck(this,e),this.userName=s,this.wins=t,this.games=n},Helpers=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"createRandomNumber",value:function(e,s){return Math.floor(Math.random()*(s-e)+e)}}]),e}(),Colors=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"generate",value:function(e){for(var s=[],t=0;t<e;t++){var n="rgb("+Helpers.createRandomNumber(0,255)+", "+Helpers.createRandomNumber(0,255)+", "+Helpers.createRandomNumber(0,255)+")";s.push(n)}return s}}]),e}(),Messages=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"clear",value:function(){UIElements.msgPane.setAttribute("class",""),UIElements.msgPane.textContent=""}},{key:"generate",value:function(e,s){UIElements.msgPane.setAttribute("class",s),UIElements.msgPane.textContent=e}}]),e}(),Controls=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"startGame",value:function(e){if(gameModeOpts.hasOwnProperty(e)){var s=Colors.generate(gameModeOpts[e].items);gameSettings=new Settings(gameModeOpts[e].items,gameModeOpts[e].guesses,s[Helpers.createRandomNumber(0,gameModeOpts[e].items)]),UI.buildGrid(s),UI.askQuestion(),UI.showHideForm(UIElements.gameSettingsForm,UIElements.cssClasses.inactive),UI.populateUserInfo()}}},{key:"CheckTiles",value:function(e){e.target.classList.contains(UIElements.cssClasses.tile)&&gameSettings.guesses>0&&(e.target.style.backgroundColor==gameSettings.answer?(Messages.generate("You Win!",UIElements.cssClasses.active+" "+UIElements.cssClasses.success),UI.disableBoard(),UI.gameOver(),LocalStorage.updateUser("win"),UI.populateUserInfo()):(gameSettings.removeGuess(),0==gameSettings.guesses?(Messages.generate("Sorry, out of guesses. Game over!",UIElements.cssClasses.active+" "+UIElements.cssClasses.error),UI.disableBoard(),UI.revealWinner(),UI.gameOver(),LocalStorage.updateUser("loss"),UI.populateUserInfo()):(e.target.setAttribute("disabled",!0),Messages.generate("Try again... "+gameSettings.guesses+" guess(es) left.",UIElements.cssClasses.active+" "+UIElements.cssClasses.warn))))}},{key:"resetGame",value:function(e){UIElements.grid.innerHTML="",UI.showHideForm(UIElements.gameSettingsForm,UIElements.cssClasses.active),UIElements.header.lastChild.remove(),Messages.clear(),e.classList.remove(UIElements.cssClasses.active)}}]),e}(),UI=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"populateUserInfo",value:function(){var e=JSON.parse(localStorage.getItem(lsKey));UIElements.userPane.querySelector(".user-name").textContent=e.userName,UIElements.userPane.querySelector(".user-score").innerHTML="Games won: <span>"+e.wins+"</span> of <span>"+e.games+"</span>"}},{key:"buildGrid",value:function(e){e.forEach(function(e){var s=document.createElement("button");s.classList.add(UIElements.cssClasses.tile),s.style.backgroundColor=e,UIElements.grid.appendChild(s)})}},{key:"askQuestion",value:function(){var e=document.createElement("div");e.setAttribute("class","game-question"),e.innerHTML="Click on the color that has a value of: <span>"+gameSettings.answer+"</span>",UIElements.header.appendChild(e),this.showTotalGuesses()}},{key:"showTotalGuesses",value:function(){UIElements.msgPane.textContent="Make a selection. You have "+gameSettings.guesses+" guesses.",UIElements.msgPane.setAttribute("class",UIElements.cssClasses.active)}},{key:"showHideForm",value:function(e,s){e.setAttribute("class",s)}},{key:"disableBoard",value:function(){document.querySelectorAll("."+UIElements.cssClasses.tile).forEach(function(e){e.style.backgroundColor!=gameSettings.answer&&e.setAttribute("disabled",!0)})}},{key:"revealWinner",value:function(){document.querySelectorAll("."+UIElements.cssClasses.tile).forEach(function(e){e.style.backgroundColor==gameSettings.answer&&e.classList.add("winner")})}},{key:"gameOver",value:function(){document.getElementById("play-again").classList.add(UIElements.cssClasses.active)}}]),e}(),LocalStorage=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getUser",value:function(){return!!localStorage.getItem(lsKey)}},{key:"setUser",value:function(e){var s=new LsObj(e.value,0,0);localStorage.setItem(lsKey,JSON.stringify(s)),UI.showHideForm(UIElements.userInfoForm,UIElements.cssClasses.inactive),UI.showHideForm(UIElements.gameSettingsForm,UIElements.cssClasses.active)}},{key:"updateUser",value:function(e){var s=JSON.parse(localStorage.getItem(lsKey));s.games+=1,"win"==e&&(s.wins+=1),localStorage.setItem(lsKey,JSON.stringify(s))}}]),e}(),lvlBtns=document.querySelectorAll(".lvl-select");lvlBtns.forEach(function(e){e.addEventListener("click",function(e){Controls.startGame(this.value),e.preventDefault()})}),UIElements.grid.addEventListener("click",function(e){Controls.CheckTiles(e),e.preventDefault()}),document.getElementById("play-again").addEventListener("click",function(){Controls.resetGame(this)}),UIElements.userInfoForm.addEventListener("submit",function(e){LocalStorage.setUser(document.querySelector('input[name="user-name"]')),e.preventDefault()}),window.addEventListener("load",function(){LocalStorage.getUser()?(UI.populateUserInfo(),UI.showHideForm(UIElements.gameSettingsForm,UIElements.cssClasses.active)):UI.showHideForm(UIElements.userInfoForm,UIElements.cssClasses.active)});